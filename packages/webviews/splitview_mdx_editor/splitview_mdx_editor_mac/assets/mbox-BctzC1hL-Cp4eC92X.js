var i=["From","Sender","Reply-To","To","Cc","Bcc","Message-ID","In-Reply-To","References","Resent-From","Resent-Sender","Resent-To","Resent-Cc","Resent-Bcc","Resent-Message-ID","Return-Path","Received"],o=["Date","Subject","Comments","Keywords","Resent-Date"],s=/^[ \t]/,d=/^From /,l=new RegExp("^("+i.join("|")+"): "),u=new RegExp("^("+o.join("|")+"): "),m=/^[^:]+:/,c=/^[^ ]+@[^ ]+/,f=/^.*?(?=[^ ]+?@[^ ]+)/,h=/^<.*?>/,p=/^.*?(?=<.*>)/;function R(e){return e==="Subject"?"header":"string"}function H(e,t){if(e.sol()){if(t.inSeparator=!1,t.inHeader&&e.match(s))return null;if(t.inHeader=!1,t.header=null,e.match(d))return t.inHeaders=!0,t.inSeparator=!0,"atom";var a,r=!1;return(a=e.match(u))||(r=!0)&&(a=e.match(l))?(t.inHeaders=!0,t.inHeader=!0,t.emailPermitted=r,t.header=a[1],"atom"):t.inHeaders&&(a=e.match(m))?(t.inHeader=!0,t.emailPermitted=!0,t.header=a[1],"atom"):(t.inHeaders=!1,e.skipToEnd(),null)}if(t.inSeparator)return e.match(c)?"link":(e.match(f)||e.skipToEnd(),"atom");if(t.inHeader){var n=R(t.header);if(t.emailPermitted){if(e.match(h))return n+" link";if(e.match(p))return n}return e.skipToEnd(),n}return e.skipToEnd(),null}const S={name:"mbox",startState:function(){return{inSeparator:!1,inHeader:!1,emailPermitted:!1,header:null,inHeaders:!1}},token:H,blankLine:function(e){e.inHeaders=e.inSeparator=e.inHeader=!1},languageData:{autocomplete:i.concat(o)}};export{S as mbox};
