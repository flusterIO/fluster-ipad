var o={},f={allTags:!0,closeAll:!0,list:!0,newJournal:!0,newTiddler:!0,permaview:!0,saveChanges:!0,search:!0,slider:!0,tabs:!0,tag:!0,tagging:!0,tags:!0,tiddler:!0,timeline:!0,today:!0,version:!0,option:!0,with:!0,filter:!0},l=/[\w_\-]/i,c=/^\-\-\-\-+$/,m=/^\/\*\*\*$/,s=/^\*\*\*\/$/,k=/^<<<$/,h=/^\/\/\{\{\{$/,d=/^\/\/\}\}\}$/,p=/^<!--\{\{\{-->$/,b=/^<!--\}\}\}-->$/,$=/^\{\{\{$/,v=/^\}\}\}$/,z=/.*?\}\}\}/;function u(t,r,n){return r.tokenize=n,n(t,r)}function i(t,r){var n=t.sol(),e=t.peek();if(r.block=!1,n&&/[<\/\*{}\-]/.test(e)){if(t.match($))return r.block=!0,u(t,r,a);if(t.match(k))return"quote";if(t.match(m)||t.match(s)||t.match(h)||t.match(d)||t.match(p)||t.match(b))return"comment";if(t.match(c))return"contentSeparator"}if(t.next(),n&&/[\/\*!#;:>|]/.test(e)){if(e=="!")return t.skipToEnd(),"header";if(e=="*")return t.eatWhile("*"),"comment";if(e=="#")return t.eatWhile("#"),"comment";if(e==";")return t.eatWhile(";"),"comment";if(e==":")return t.eatWhile(":"),"comment";if(e==">")return t.eatWhile(">"),"quote";if(e=="|")return"header"}if(e=="{"&&t.match("{{"))return u(t,r,a);if(/[hf]/i.test(e)&&/[ti]/i.test(t.peek())&&t.match(/\b(ttps?|tp|ile):\/\/[\-A-Z0-9+&@#\/%?=~_|$!:,.;]*[A-Z0-9+&@#\/%=~_|$]/i))return"link";if(e=='"')return"string";if(e=="~"||/[\[\]]/.test(e)&&t.match(e))return"brace";if(e=="@")return t.eatWhile(l),"link";if(/\d/.test(e))return t.eatWhile(/\d/),"number";if(e=="/"){if(t.eat("%"))return u(t,r,w);if(t.eat("/"))return u(t,r,W)}if(e=="_"&&t.eat("_"))return u(t,r,g);if(e=="-"&&t.eat("-")){if(t.peek()!=" ")return u(t,r,_);if(t.peek()==" ")return"brace"}return e=="'"&&t.eat("'")?u(t,r,x):e=="<"&&t.eat("<")?u(t,r,y):(t.eatWhile(/[\w\$_]/),o.propertyIsEnumerable(t.current())?"keyword":null)}function w(t,r){for(var n=!1,e;e=t.next();){if(e=="/"&&n){r.tokenize=i;break}n=e=="%"}return"comment"}function x(t,r){for(var n=!1,e;e=t.next();){if(e=="'"&&n){r.tokenize=i;break}n=e=="'"}return"strong"}function a(t,r){var n=r.block;return n&&t.current()?"comment":!n&&t.match(z)||n&&t.sol()&&t.match(v)?(r.tokenize=i,"comment"):(t.next(),"comment")}function W(t,r){for(var n=!1,e;e=t.next();){if(e=="/"&&n){r.tokenize=i;break}n=e=="/"}return"emphasis"}function g(t,r){for(var n=!1,e;e=t.next();){if(e=="_"&&n){r.tokenize=i;break}n=e=="_"}return"link"}function _(t,r){for(var n=!1,e;e=t.next();){if(e=="-"&&n){r.tokenize=i;break}n=e=="-"}return"deleted"}function y(t,r){if(t.current()=="<<")return"meta";var n=t.next();return n?n==">"&&t.peek()==">"?(t.next(),r.tokenize=i,"meta"):(t.eatWhile(/[\w\$_]/),f.propertyIsEnumerable(t.current())?"keyword":null):(r.tokenize=i,null)}const S={name:"tiddlywiki",startState:function(){return{tokenize:i}},token:function(t,r){if(t.eatSpace())return null;var n=r.tokenize(t,r);return n}};export{S as tiddlyWiki};
