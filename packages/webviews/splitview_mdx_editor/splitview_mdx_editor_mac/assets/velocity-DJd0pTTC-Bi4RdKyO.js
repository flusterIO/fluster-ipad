function u(t){for(var e={},r=t.split(" "),a=0;a<r.length;++a)e[r[a]]=!0;return e}var f=u("#end #else #break #stop #[[ #]] #{end} #{else} #{break} #{stop}"),i=u("#if #elseif #foreach #set #include #parse #macro #define #evaluate #{if} #{elseif} #{foreach} #{set} #{include} #{parse} #{macro} #{define} #{evaluate}"),c=u("$foreach.count $foreach.hasNext $foreach.first $foreach.last $foreach.topmost $foreach.parent.count $foreach.parent.hasNext $foreach.parent.first $foreach.parent.last $foreach.parent $velocityCount $!bodyContent $bodyContent"),k=/[+\-*&%=<>!?:\/|]/;function s(t,e,r){return e.tokenize=r,r(t,e)}function o(t,e){var r=e.beforeParams;e.beforeParams=!1;var a=t.next();if(a=="'"&&!e.inString&&e.inParams)return e.lastTokenWasBuiltin=!1,s(t,e,p(a));if(a=='"'){if(e.lastTokenWasBuiltin=!1,e.inString)return e.inString=!1,"string";if(e.inParams)return s(t,e,p(a))}else{if(/[\[\]{}\(\),;\.]/.test(a))return a=="("&&r?e.inParams=!0:a==")"&&(e.inParams=!1,e.lastTokenWasBuiltin=!0),null;if(/\d/.test(a))return e.lastTokenWasBuiltin=!1,t.eatWhile(/[\w\.]/),"number";if(a=="#"&&t.eat("*"))return e.lastTokenWasBuiltin=!1,s(t,e,m);if(a=="#"&&t.match(/ *\[ *\[/))return e.lastTokenWasBuiltin=!1,s(t,e,h);if(a=="#"&&t.eat("#"))return e.lastTokenWasBuiltin=!1,t.skipToEnd(),"comment";if(a=="$")return t.eat("!"),t.eatWhile(/[\w\d\$_\.{}-]/),c&&c.propertyIsEnumerable(t.current())?"keyword":(e.lastTokenWasBuiltin=!0,e.beforeParams=!0,"builtin");if(k.test(a))return e.lastTokenWasBuiltin=!1,t.eatWhile(k),"operator";t.eatWhile(/[\w\$_{}@]/);var n=t.current();return f&&f.propertyIsEnumerable(n)?"keyword":i&&i.propertyIsEnumerable(n)||t.current().match(/^#@?[a-z0-9_]+ *$/i)&&t.peek()=="("&&!(i&&i.propertyIsEnumerable(n.toLowerCase()))?(e.beforeParams=!0,e.lastTokenWasBuiltin=!1,"keyword"):e.inString?(e.lastTokenWasBuiltin=!1,"string"):t.pos>n.length&&t.string.charAt(t.pos-n.length-1)=="."&&e.lastTokenWasBuiltin?"builtin":(e.lastTokenWasBuiltin=!1,null)}}function p(t){return function(e,r){for(var a=!1,n,l=!1;(n=e.next())!=null;){if(n==t&&!a){l=!0;break}if(t=='"'&&e.peek()=="$"&&!a){r.inString=!0,l=!0;break}a=!a&&n=="\\"}return l&&(r.tokenize=o),"string"}}function m(t,e){for(var r=!1,a;a=t.next();){if(a=="#"&&r){e.tokenize=o;break}r=a=="*"}return"comment"}function h(t,e){for(var r=0,a;a=t.next();){if(a=="#"&&r==2){e.tokenize=o;break}a=="]"?r++:a!=" "&&(r=0)}return"meta"}const b={name:"velocity",startState:function(){return{tokenize:o,beforeParams:!1,inParams:!1,inString:!1,lastTokenWasBuiltin:!1}},token:function(t,e){return t.eatSpace()?null:e.tokenize(t,e)},languageData:{commentTokens:{line:"##",block:{open:"#*",close:"*#"}}}};export{b as velocity};
